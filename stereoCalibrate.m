% Auto-generated by stereoCalibrator app on 08-May-2016
%-------------------------------------------------------


% Define images to process
imageFileNames1 = {'E:\Matlab\data\strawberry\calibration\infrared\15435621-2016-04-27-120106.png',...
    'E:\Matlab\data\strawberry\calibration\infrared\15435621-2016-04-27-120830.png',...
    'E:\Matlab\data\strawberry\calibration\infrared\15435621-2016-04-27-121009.png',...
    'E:\Matlab\data\strawberry\calibration\infrared\15435621-2016-04-27-121108.png',...
    'E:\Matlab\data\strawberry\calibration\infrared\15435621-2016-04-27-121223.png',...
    'E:\Matlab\data\strawberry\calibration\infrared\15435621-2016-04-27-121351.png',...
    'E:\Matlab\data\strawberry\calibration\infrared\15435621-2016-04-27-121427.png',...
    'E:\Matlab\data\strawberry\calibration\infrared\15435621-2016-04-27-121550.png',...
    'E:\Matlab\data\strawberry\calibration\infrared\15435621-2016-04-27-121633.png',...
    'E:\Matlab\data\strawberry\calibration\infrared\15435621-2016-04-27-121910.png',...
    'E:\Matlab\data\strawberry\calibration\infrared\15435621-2016-04-27-121956.png',...
    'E:\Matlab\data\strawberry\calibration\infrared\15435621-2016-04-27-122031.png',...
    'E:\Matlab\data\strawberry\calibration\infrared\15435621-2016-04-27-123016.png',...
    'E:\Matlab\data\strawberry\calibration\infrared\15435621-2016-04-27-123211.png',...
    'E:\Matlab\data\strawberry\calibration\infrared\15435621-2016-04-27-123234.png',...
    'E:\Matlab\data\strawberry\calibration\infrared\15435621-2016-04-27-123330.png',...
    'E:\Matlab\data\strawberry\calibration\infrared\15435621-2016-04-27-123545.png',...
    'E:\Matlab\data\strawberry\calibration\infrared\15435621-2016-04-27-123926.png',...
    'E:\Matlab\data\strawberry\calibration\infrared\15435621-2016-04-27-124119.png',...
    'E:\Matlab\data\strawberry\calibration\infrared\15435621-2016-04-27-124227.png',...
    };
imageFileNames2 = {'E:\Matlab\data\strawberry\calibration\pSingleband\SSM4x4-VIS_49570354_20160427120102.png',...
    'E:\Matlab\data\strawberry\calibration\pSingleband\SSM4x4-VIS_49570354_20160427120850.png',...
    'E:\Matlab\data\strawberry\calibration\pSingleband\SSM4x4-VIS_49570354_20160427121000.png',...
    'E:\Matlab\data\strawberry\calibration\pSingleband\SSM4x4-VIS_49570354_20160427121100.png',...
    'E:\Matlab\data\strawberry\calibration\pSingleband\SSM4x4-VIS_49570354_20160427121215.png',...
    'E:\Matlab\data\strawberry\calibration\pSingleband\SSM4x4-VIS_49570354_20160427121338.png',...
    'E:\Matlab\data\strawberry\calibration\pSingleband\SSM4x4-VIS_49570354_20160427121421.png',...
    'E:\Matlab\data\strawberry\calibration\pSingleband\SSM4x4-VIS_49570354_20160427121542.png',...
    'E:\Matlab\data\strawberry\calibration\pSingleband\SSM4x4-VIS_49570354_20160427121624.png',...
    'E:\Matlab\data\strawberry\calibration\pSingleband\SSM4x4-VIS_49570354_20160427121928.png',...
    'E:\Matlab\data\strawberry\calibration\pSingleband\SSM4x4-VIS_49570354_20160427122000.png',...
    'E:\Matlab\data\strawberry\calibration\pSingleband\SSM4x4-VIS_49570354_20160427122025.png',...
    'E:\Matlab\data\strawberry\calibration\pSingleband\SSM4x4-VIS_49570354_20160427123116.png',...
    'E:\Matlab\data\strawberry\calibration\pSingleband\SSM4x4-VIS_49570354_20160427123204.png',...
    'E:\Matlab\data\strawberry\calibration\pSingleband\SSM4x4-VIS_49570354_20160427123238.png',...
    'E:\Matlab\data\strawberry\calibration\pSingleband\SSM4x4-VIS_49570354_20160427123322.png',...
    'E:\Matlab\data\strawberry\calibration\pSingleband\SSM4x4-VIS_49570354_20160427123549.png',...
    'E:\Matlab\data\strawberry\calibration\pSingleband\SSM4x4-VIS_49570354_20160427123921.png',...
    'E:\Matlab\data\strawberry\calibration\pSingleband\SSM4x4-VIS_49570354_20160427124124.png',...
    'E:\Matlab\data\strawberry\calibration\pSingleband\SSM4x4-VIS_49570354_20160427124218.png',...
    };

% Detect checkerboards in images
[imagePoints, boardSize, imagesUsed] = detectCheckerboardPoints(imageFileNames1, imageFileNames2);

% Generate world coordinates of the checkerboard keypoints
squareSize = 25;  % in units of 'mm'
worldPoints = generateCheckerboardPoints(boardSize, squareSize);

% Calibrate the camera
[stereoParams, pairsUsed, estimationErrors] = estimateCameraParameters(imagePoints, worldPoints, ...
    'EstimateSkew', false, 'EstimateTangentialDistortion', false, ...
    'NumRadialDistortionCoefficients', 2, 'WorldUnits', 'mm', ...
    'InitialIntrinsicMatrix', [], 'InitialRadialDistortion', []);

% View reprojection errors
%h1=figure; showReprojectionErrors(stereoParams, 'CameraCentric');

% Visualize pattern locations
h2=figure; showExtrinsics(stereoParams, 'CameraCentric');

% Display parameter estimation errors
displayErrors(estimationErrors, stereoParams);

% You can use the calibration data to rectify stereo images.
I1 = imread(imageFileNames1{1});
I2 = imread(imageFileNames2{1});
[J1, J2] = rectifyStereoImages(I1, I2, stereoParams);

% See additional examples of how to use the calibration data.  At the prompt type:
% showdemo('StereoCalibrationAndSceneReconstructionExample')
% showdemo('DepthEstimationFromStereoVideoExample')
